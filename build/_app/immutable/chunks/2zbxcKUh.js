import{U as E,a2 as y,a9 as b,a3 as M,D as A,W as I,h as S,Q as k,ac as L,X as w,I as B,E as N,ad as Y,K as x,M as F,O as U,G as C,P as R,b as q,ae as G,af as $,ag as j,g,f as z,J as H,aa as J,p as K,ah as Q,ai as W,aj as X,ak as Z,al as V,am as ee,an as te,ao as ae,ap as se,aq as re}from"./BxRSIDWW.js";import{c as ie}from"./nhi-4Ff5.js";class ne{anchor;#t=new Map;#a=new Map;#e=new Map;#s=new Set;#r=!0;constructor(e,a=!0){this.anchor=e,this.#r=a}#i=()=>{var e=E;if(this.#t.has(e)){var a=this.#t.get(e),t=this.#a.get(a);if(t)y(t),this.#s.delete(a);else{var n=this.#e.get(a);n&&(this.#a.set(a,n.effect),this.#e.delete(a),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),t=n.effect)}for(const[s,i]of this.#t){if(this.#t.delete(s),s===e)break;const r=this.#e.get(i);r&&(b(r.effect),this.#e.delete(i))}for(const[s,i]of this.#a){if(s===a||this.#s.has(s))continue;const r=()=>{if(Array.from(this.#t.values()).includes(s)){var h=document.createDocumentFragment();L(i,h),h.append(A()),this.#e.set(s,{effect:i,fragment:h})}else b(i);this.#s.delete(s),this.#a.delete(s)};this.#r||!t?(this.#s.add(s),M(i,r,!1)):r()}}};#n=e=>{this.#t.delete(e);const a=Array.from(this.#t.values());for(const[t,n]of this.#e)a.includes(t)||(b(n.effect),this.#e.delete(t))};ensure(e,a){var t=E,n=w();if(a&&!this.#a.has(e)&&!this.#e.has(e))if(n){var s=document.createDocumentFragment(),i=A();s.append(i),this.#e.set(e,{effect:I(()=>a(i)),fragment:s})}else this.#a.set(e,I(()=>a(this.anchor)));if(this.#t.set(t,e),n){for(const[r,f]of this.#a)r===e?t.skipped_effects.delete(f):t.skipped_effects.add(f);for(const[r,f]of this.#e)r===e?t.skipped_effects.delete(f.effect):t.skipped_effects.add(f.effect);t.oncommit(this.#i),t.ondiscard(this.#n)}else S&&(this.anchor=k),this.#i()}}function de(d,e,a=!1){S&&B();var t=new ne(d),n=a?Y:0;function s(i,r){if(S){const h=x(d)===F;if(i===h){var f=U();C(f),t.anchor=f,R(!1),t.ensure(i,r),R(!0);return}}t.ensure(i,r)}N(()=>{var i=!1;e((r,f=!0)=>{i=!0,s(f,r)}),i||s(!1,null)},n)}function he(d,e,a,t){var n=!ee||(a&te)!==0,s=(a&V)!==0,i=(a&Z)!==0,r=t,f=!0,h=()=>(f&&(f=!1,r=i?q(t):t),r),o;if(s){var T=se in d||re in d;o=G(d,e)?.set??(T&&e in d?c=>d[e]=c:void 0)}var _,p=!1;s?[_,p]=ie(()=>d[e]):_=d[e],_===void 0&&t!==void 0&&(_=h(),o&&(n&&$(),o(_)));var u;if(n?u=()=>{var c=d[e];return c===void 0?h():(f=!0,c)}:u=()=>{var c=d[e];return c!==void 0&&(r=void 0),c===void 0?r:c},n&&(a&j)===0)return u;if(o){var O=d.$$legacy;return(function(c,v){return arguments.length>0?((!n||!v||O||p)&&o(v?u():c),c):u()})}var m=!1,l=((a&ae)!==0?z:H)(()=>(m=!1,u()));s&&g(l);var D=W;return(function(c,v){if(arguments.length>0){const P=v?g(l):n&&s?J(c):c;return K(l,P),m=!0,r!==void 0&&(r=P),c}return Q&&m||(D.f&X)!==0?l.v:g(l)})}export{ne as B,de as i,he as p};
